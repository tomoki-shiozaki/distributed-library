@startuml system_architecture
skinparam defaultFontName "Noto Sans CJK JP"
left to right direction


actor User
actor Developer

package "GitHub" {
  component "GitHub Repository" as GitHubRepo
}

package "Google Cloud" {
  component "Cloud Build" as CloudBuild
  component "Artifact Registry" as ArtifactRegistry
  component "Cloud Run" as CloudRun
  component "Cloud Logging" as Logging
  component "Secret Manager" as SecretManager
}

package "Neon" {
  component "Neon PostgreSQL" as NeonPostgreSQL
}

package "External APIs" {
  component "Google Books API" as GoogleBooksAPI
}

' 開発からデプロイ
Developer --> GitHubRepo : Push Code
GitHubRepo --> CloudBuild : Trigger CI/CD
CloudBuild --> ArtifactRegistry : Push Container Image
CloudBuild --> CloudRun : Deploy Image
ArtifactRegistry --> CloudRun : Pull Image

' シークレット管理
CloudRun --> SecretManager : Fetch Secrets


' アプリ実行
User --> CloudRun : HTTP Request
CloudRun --> NeonPostgreSQL : DB Access
CloudRun ..> Logging : Send Logs

' 本の情報取得
CloudRun --> GoogleBooksAPI : Fetch Book Info (by ISBN)

@enduml
